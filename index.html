<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שלד טבלה</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the table to match the image's appearance */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }
        .table-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow-x: auto; /* Allows horizontal scrolling on small screens if content overflows */
            width: 100%;
            max-width: 1200px;
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            table-layout: fixed; /* Ensures column widths are respected */
        }
        th, td {
            padding: 12px 16px;
            text-align: right;
            border-bottom: 1px solid #e2e8f0;
            position: relative; /* Needed for absolute positioning of cell numbers */
            vertical-align: top; /* Align content to the top of the cell */
        }
        th {
            background-color: #ffe0e6; /* Light pink background for headers */
            color: #333;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap; /* Keep headers on one line */
        }
        td {
            white-space: normal; /* Allow text wrapping within data cells */
        }
        tr:nth-child(even) {
            background-color: #f8faff; /* Light blueish background for even rows */
        }
        tr:hover {
            background-color: #f0f4f8; /* Hover effect for rows */
        }
        .header-top-left {
            background-color: #ffcc00; /* Yellow background for "הערכת מצב בשעה" */
            color: #000;
            font-weight: bold;
            text-align: center;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: inline-block;
            position: relative; /* Needed for absolute positioning of cell number */
        }
        .dropdown-cell {
            position: relative;
        }
        .dropdown-cell select {
            appearance: none; /* Remove default arrow */
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: #e0f2fe; /* Light blue background for dropdowns */
            border: 1px solid #90cdf4;
            border-radius: 6px;
            padding: 8px 30px 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #2c5282;
            width: 100%;
            min-width: 100px; /* Reduced min-width for mobile flexibility */
        }
        .dropdown-cell select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
        }
        .dropdown-cell::after {
            content: '▼'; /* Custom dropdown arrow */
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            pointer-events: none;
            color: #2c5282;
        }
        /* Style for displaying cell numbers */
        .cell-number {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7em;
            color: #888;
            padding: 1px 4px;
            border-radius: 4px;
            z-index: 1;
        }
        /* Style for input fields and textareas within cells */
        .cell-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 0.9rem;
            resize: vertical; /* Allow vertical resizing, but not horizontal */
            min-height: 38px; /* Ensure consistent height with single-line input */
            vertical-align: top; /* Align text to the top for multi-line */
            white-space: normal; /* Allow text wrapping within textarea */
        }
        .cell-input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
        }

        /* Responsive Column Widths and Visibility for table rows */
        /* Default general widths for table data rows */
        .col-description { width: 30%; }
        .col-date { width: 15%; }
        .col-time { width: 15%; }
        .col-reporter { width: 20%; }
        .col-journal { width: 20%; }

        /* Mobile specific overrides for table data rows (max-width: 767px) */
        @media (max-width: 767px) {
            /* Hide date and time headers on mobile */
            thead .col-date,
            thead .col-time {
                display: none;
            }

            /* Adjust widths for all table data rows on mobile */
            td.col-description { width: 35%; }
            td.col-date { display: table-cell; width: 15%; } /* Keep visible for data rows */
            td.col-time { display: table-cell; width: 15%; } /* Keep visible for data rows */
            td.col-reporter { width: 20%; }
            td.col-journal { width: 15%; }
        }

        /* On medium screens (tablets and up), apply standard widths and ensure visibility */
        @media (min-width: 768px) { /* md breakpoint */
            thead .col-date,
            thead .col-time,
            td.col-date,
            td.col-time {
                display: table-cell !important; /* Ensure visible for all rows */
            }
            .col-description { width: 25%; }
            .col-date { width: 15%; }
            .col-time { width: 15%; }
            .col-reporter { width: 25%; }
            .col-journal { width: 20%; }
        }

        /* On large screens (desktops and up), adjust widths */
        @media (min-width: 1024px) { /* lg breakpoint */
            .col-description { width: 30%; }
            .col-date { width: 15%; }
            .col-time { width: 15%; }
            .col-reporter { width: 20%; }
            .col-journal { width: 20%; }
        }

        /* Specific styling for the separate input form area */
        .input-form-area {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 16px;
            margin-bottom: 20px; /* Space between input area and table */
            width: 100%;
            max-width: 1200px;
            box-sizing: border-box; /* Include padding in width */
            display: flex;
            flex-direction: column; /* Stack items vertically by default */
            gap: 10px; /* Space between input elements */
        }
        .input-form-area .main-input-wrapper {
            flex-grow: 1;
        }
        .input-form-area .select-group {
            display: flex;
            gap: 10px;
        }
        .input-form-area .select-group > div {
            flex-basis: 50%; /* Each select wrapper takes half width */
            flex-grow: 1;
        }

        /* Adjust input elements within the form area */
        .input-form-area .cell-input,
        .input-form-area .dropdown-cell select {
            border: 1px solid #d1d5db; /* Lighter border for clean look */
            background-color: #f9fafb; /* Very light background */
        }
        .input-form-area .dropdown-cell select {
            min-height: 38px; /* Match textarea/input height */
            padding-right: 30px; /* Space for custom arrow */
        }

        /* Mobile adjustments for the input form area */
        @media (max-width: 767px) {
            .input-form-area .select-group {
                flex-direction: row; /* Keep selects side by side on small screens */
            }
            .input-form-area .select-group > div {
                flex-basis: 50%;
            }
        }

        /* Tablet/Desktop adjustments for the input form area (optional, can inherit from default) */
        @media (min-width: 768px) {
            .input-form-area {
                flex-direction: column; /* Still stack textarea on top, selects below */
                gap: 15px;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <!-- Top left header as seen in the image, conceptually A1/A2 -->
    <div class="header-top-left" id="header-top-left">
        הערכת מצב בשעה 13:00
        <span class="cell-number">A2</span>
    </div>

    <!-- Separate input form area (Conceptual A3, D3, E3) -->
    <div class="input-form-area">
        <div class="main-input-wrapper">
            <textarea class="cell-input" id="inputA3" rows="1" placeholder="תיאור האירוע"></textarea>
        </div>
        <div class="select-group">
            <div>
                <div class="dropdown-cell">
                    <select class="reporter-name-select" id="inputD3">
                        <option value="">שם המדווח</option>
                        <option value="שונית">שונית</option>
                        <option value="אורי">אורי</option>
                        <option value="יעקב">יעקב</option>
                        <option value="משה">משה</option>
                    </select>
                </div>
            </div>
            <div>
                <div class="dropdown-cell">
                    <select class="journal-assignment-select" id="inputE3">
                        <option value="">שיוך יומן</option>
                        <option value="חרבות ברזל">חרבות ברזל</option>
                        <option value="תרגיל">תרגיל</option>
                        <option value="שריפה">שריפה</option>
                        <option value="שגרה">שגרה</option>
                        <option value="אחר">אחר</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="table-container">
        <table class="min-w-full">
            <thead>
                <tr>
                    <!-- Row 2 (headers) -->
                    <th class="rounded-tr-lg col-description">
                        תיאור האירוע
                    </th>
                    <th class="col-date">
                        תאריך
                    </th>
                    <th class="col-time">
                        שעה
                    </th>
                    <th class="col-reporter">
                        שם המדווח
                    </th>
                    <th class="rounded-tl-lg col-journal">
                        שיוך יומן
                    </th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Example Row 1 (original A3, now A4) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1">תרגיל</textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="04/06/2025">
                    </td>
                    <td class="col-time">
                        <input type="text" class="cell-input" value="17:52:42">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value="שונית">שונית</option>
                            <option value="אורי">אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל" selected>תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</option>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
                <!-- Example Row 2 (original A4, now A5) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1">תרגיל כיבוי אש</textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="04/06/2025">
                    </td>
                    <td>
                        <input type="text" class="cell-input" value="17:52:36">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value="שונית" selected>שונית</option>
                            <option value="אורי">אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל">תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</d>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
                <!-- Example Row 3 (original A5, now A6) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1">סיום תרגיל</textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="26/05/2025">
                    </td>
                    <td>
                        <input type="text" class="cell-input" value="21:28:20">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value="שונית">שונית</option>
                            <option value="אורי" selected>אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל">תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</option>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
                <!-- Example Row 4 (original A6, now A7) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1">תרגיל כיתת כוננות כולל הקפצה במערכת ה"נץ"</textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="26/05/2025">
                    </td>
                    <td>
                        <input type="text" class="cell-input" value="18:46:50">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value="שונית">שונית</option>
                            <option value="אורי" selected>אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל">תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</option>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
                <!-- Empty row for additional entries (original A7, now A8) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1"></textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="">
                    </td>
                    <td>
                        <input type="text" class="cell-input" value="">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value=""></option>
                            <option value="שונית">שונית</option>
                            <option value="אורי">אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value=""></option>
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל">תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</option>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
                <!-- Empty row for additional entries (original A8, now A9) -->
                <tr>
                    <td class="col-description">
                        <textarea class="cell-input" rows="1"></textarea>
                    </td>
                    <td class="col-date">
                        <input type="text" class="cell-input" value="">
                    </td>
                    <td>
                        <input type="text" class="cell-input" value="">
                    </td>
                    <td class="dropdown-cell col-reporter">
                        <select class="reporter-name-select">
                            <option value=""></option>
                            <option value="שונית">שונית</option>
                            <option value="אורי">אורי</option>
                            <option value="יעקב">יעקב</option>
                            <option value="משה">משה</option>
                        </select>
                    </td>
                    <td class="dropdown-cell col-journal">
                        <select class="journal-assignment-select">
                            <option value=""></option>
                            <option value="חרבות ברזל">חרבות ברזל</option>
                            <option value="תרגיל">תרגיל</option>
                            <option value="שריפה">שריפה</option>
                            <option value="שגרה">שגרה</option>
                            <option value="אחר">אחר</option>
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tableBody = document.getElementById('table-body');
            // Re-map inputA3, inputD3, inputE3 to the elements in the new input-form-area
            let inputA3 = document.getElementById('inputA3');
            let inputD3 = document.getElementById('inputD3');
            let inputE3 = document.getElementById('inputE3');

            // Options for dropdowns
            const reporterNames = ["שונית", "אורי", "יעקב", "משה"];
            const journalAssignments = ["חרבות ברזל", "תרגיל", "שריפה", "שגרה", "אחר"];

            // Function to create a select element with given options
            function createSelectElement(options, selectedValue = '', className = '') {
                const select = document.createElement('select');
                select.className = className; // Add a class for easier targeting
                const emptyOption = document.createElement('option');
                emptyOption.value = '';
                emptyOption.textContent = '';
                select.appendChild(emptyOption);

                options.forEach(optionText => {
                    const option = document.createElement('option');
                    option.value = optionText;
                    option.textContent = optionText;
                    if (optionText === selectedValue) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
                return select;
            }

            // Function to auto-resize textarea based on content
            function autoResizeTextarea(textarea) {
                if (textarea) {
                    textarea.style.height = 'auto'; // Reset height to recalculate
                    textarea.style.height = (textarea.scrollHeight) + 'px'; // Set height to scrollHeight
                }
            }

            // Function to update cell numbers dynamically
            function updateCellNumbers() {
                // Update header-top-left cell number (A2)
                const headerTopLeft = document.getElementById('header-top-left');
                let headerCellNumberSpan = headerTopLeft.querySelector('.cell-number');
                if (!headerCellNumberSpan) {
                    headerCellNumberSpan = document.createElement('span');
                    headerCellNumberSpan.className = 'cell-number';
                    headerTopLeft.appendChild(headerCellNumberSpan);
                }
                headerCellNumberSpan.textContent = 'A2';

                // Update cell numbers for table headers (row 2)
                const headerRow = document.querySelector('thead tr');
                const columnLetters = ['A', 'B', 'C', 'D', 'E'];
                Array.from(headerRow.children).forEach((th, colIndex) => {
                    let cellNumberSpan = th.querySelector('.cell-number');
                    if (!cellNumberSpan) {
                        cellNumberSpan = document.createElement('span');
                        cellNumberSpan.className = 'cell-number';
                        th.appendChild(cellNumberSpan);
                    }
                    // Headers are conceptually in row 2
                    cellNumberSpan.textContent = `${columnLetters[colIndex]}2`;
                });

                // The input form area now conceptually represents A3, D3, E3. No numbers directly on it.

                // Update cell numbers for data rows (starting from conceptual row 4)
                const rows = tableBody.getElementsByTagName('tr');
                Array.from(rows).forEach((row, rowIndex) => {
                    // Data rows start from conceptual row 4 in the Excel sheet
                    const conceptualRowNumber = rowIndex + 4;
                    Array.from(row.children).forEach((cell, colIndex) => {
                        let cellNumberSpan = cell.querySelector('.cell-number');
                        if (!cellNumberSpan) {
                            cellNumberSpan = document.createElement('span');
                            cellNumberSpan.className = 'cell-number';
                            cell.appendChild(cellNumberSpan);
                        }
                        cellNumberSpan.textContent = `${columnLetters[colIndex]}${conceptualRowNumber}`;
                    });
                });
            }

            // Initial update of cell numbers on page load
            updateCellNumbers();

            // Auto-resize all existing textareas on load (including the new inputA3)
            document.querySelectorAll('textarea.cell-input').forEach(textarea => {
                autoResizeTextarea(textarea);
            });

            // Add input event listener to inputA3 for auto-resizing
            inputA3.addEventListener('input', () => autoResizeTextarea(inputA3));


            // Define the event handler function for the Enter key
            function handleEnterKey(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent default Enter key behavior (e.g., form submission or newline in textarea)

                    const enteredText = inputA3.value; // Get the text from the current A3 textarea
                    const reporterNameValue = inputD3.value; // Get value from D3 select
                    const journalAssignmentValue = inputE3.value; // Get value from E3 select

                    // Get current date and time
                    const now = new Date();
                    const date = now.toLocaleDateString('he-IL'); // DD/MM/YYYY
                    const time = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit', second: '2-digit' }); // HH:MM:SS

                    // Create a new table row (which will become the new A4, B4, C4, D4, E4)
                    const newTableRow = document.createElement('tr');
                    newTableRow.innerHTML = `
                        <td class="col-description"></td>
                        <td class="col-date"></td>
                        <td class="col-time"></td>
                        <td class="dropdown-cell col-reporter"></td>
                        <td class="dropdown-cell col-journal"></td>
                    `;

                    // Populate the new table row
                    // Make A4 editable as textarea
                    const descriptionTextarea = document.createElement('textarea');
                    descriptionTextarea.className = 'cell-input';
                    descriptionTextarea.value = enteredText;
                    descriptionTextarea.rows = 1;
                    newTableRow.children[0].appendChild(descriptionTextarea);
                    autoResizeTextarea(descriptionTextarea); // Resize after content is set

                    // Make B4 (תאריך) editable as input
                    const dateInput = document.createElement('input');
                    dateInput.type = 'text';
                    dateInput.className = 'cell-input';
                    dateInput.value = date;
                    newTableRow.children[1].appendChild(dateInput);

                    // Make C4 (שעה) editable as input
                    const timeInput = document.createElement('input');
                    timeInput.type = 'text';
                    timeInput.className = 'cell-input';
                    timeInput.value = time;
                    newTableRow.children[2].appendChild(timeInput);

                    // For column D (שם המדווח): add select
                    newTableRow.children[3].appendChild(createSelectElement(reporterNames, reporterNameValue, 'reporter-name-select'));

                    // For column E (שיוך יומן): add select
                    newTableRow.children[4].appendChild(createSelectElement(journalAssignments, journalAssignmentValue, 'journal-assignment-select'));

                    // Insert the new table row at the beginning of the table body
                    tableBody.prepend(newTableRow);

                    // Clear the input form area
                    inputA3.value = '';
                    inputD3.value = '';
                    inputE3.value = '';
                    autoResizeTextarea(inputA3); // Reset textarea height

                    // Update all cell numbers after adding the new row
                    updateCellNumbers();

                    // Focus on the A3 input field in the separate form area
                    inputA3.focus();
                }
            }

            // Attach the event listener to the input field in A3
            inputA3.addEventListener('keydown', handleEnterKey);
        });
    </script>
</body>
</html>
